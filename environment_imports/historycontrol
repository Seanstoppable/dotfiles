export HISTSIZE="UNLIMITED"
export HISTFILESIZE="UNLIMITED"
export HISTCONTROL=ignoredups:erasedups:ignorespace
export HISTIGNORE='&:bg:fg:clear:ls:pwd:history:exit:* --help:'
export HISTTIMEFORMAT="%Y-%m-%d %H:%M:%S "

shopt -s histappend

history() {
  _bash_history_sync
  builtin history "$@"
}

_bash_history_sync() {
  builtin history -a         #1
  HISTFILESIZE=$HISTFILESIZE #2
  builtin history -c         #3
  builtin history -r         #4
}

export PROMPT_COMMAND="${PROMPT_COMMAND:+$PROMPT_COMMAND$'\n'}_bash_history_sync"
